<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AskAdriaan - PRTS Handbook Assistant</title>
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==">
    <script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #F3F3F4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        #webchat-container {
            width: 420px;
            height: 620px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(28, 28, 28, 0.12);
            border: 1px solid #e0e0e0;
            background: white;
            resize: both;
            min-width: 320px;
            min-height: 400px;
            max-width: none;
            max-height: none;
            display: flex;
            flex-direction: column;
        }
        #header {
            background: white;
            padding: 24px 24px 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 1px solid #f0f0f0;
            flex-shrink: 0;
        }
        #header-content {
            flex: 1;
        }
        #header h1 {
            margin: 0 0 4px 0;
            color: #DA2037;
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        #header p {
            margin: 0;
            color: #6b6b6b;
            font-size: 13px;
            font-weight: 400;
        }
        #fullscreen-btn {
            background: #f5f5f5;
            border: none;
            color: #6b6b6b;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
            margin-left: 12px;
        }
        #fullscreen-btn:hover {
            background: #e8e8e8;
            color: #DA2037;
        }
        #webchat {
            flex: 1;
            width: 100%;
            min-height: 0;
        }
        #webchat-container.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw !important;
            height: 100vh !important;
            max-width: none;
            border-radius: 0;
            z-index: 9999;
        }
        #webchat-container.fullscreen #webchat {
            height: calc(100vh - 90px);
        }
    </style>
</head>
<body>
    <div id="webchat-container">
        <div id="header">
            <div id="header-content">
                <h1>AskAdriaan</h1>
                <p>PRTS Handbook Assistant</p>
            </div>
            <button id="fullscreen-btn" onclick="toggleFullscreen()" title="Toggle fullscreen">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1 5V1H5M11 1H15V5M15 11V15H11M5 15H1V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
        </div>
        <div id="webchat" role="main"></div>
    </div>

    <script>
        const tokenEndpoint = 'https://default61d6eb67cbe542ee8a1373c46652bd.71.environment.api.powerplatform.com/powervirtualagents/botsbyschema/cr2ce_askAdrian/directline/token?api-version=2022-03-01-preview';
        
        // Embedded bot avatar icon - exact AskAdriaan logo
        const botAvatarSVG = 'data:image/png;base64,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';
        
        const styleOptions = {
            accent: '#DA2037',
            backgroundColor: 'white',
            bubbleBackground: '#F3F3F4',
            bubbleFromUserBackground: '#D3D8DC',
            bubbleFromUserTextColor: '#1C1C1C',
            bubbleBorderRadius: 16,
            bubbleFromUserBorderRadius: 16,
            bubbleTextColor: '#1C1C1C',
            sendBoxBackground: 'white',
            sendBoxTextColor: '#1C1C1C',
            sendBoxBorderTop: 'solid 1px #f0f0f0',
            sendBoxPlaceholderColor: '#999999',
            sendBoxButtonColor: '#DA2037',
            sendBoxButtonColorOnHover: '#b81a2d',
            sendBoxHeight: 50,
            sendBoxButtonColorOnFocus: '#b81a2d',
            suggestedActionBackground: 'white',
            suggestedActionBorderColor: '#DA2037',
            suggestedActionBorderRadius: 20,
            suggestedActionTextColor: '#DA2037',
            suggestedActionBorderWidth: 1.5,
            timestampColor: '#999999',
            botAvatarBackgroundColor: 'transparent',
            botAvatarImage: botAvatarSVG,
            botAvatarInitials: '',
            userAvatarBackgroundColor: '#1C1C1C',
            userAvatarInitials: '',
            avatarSize: 60,
            avatarBorderRadius: '15%',
            hideUploadButton: false,
            groupTimestamp: 300000
        };

        async function initWebChat() {
            try {
                const res = await fetch(tokenEndpoint);
                const { token } = await res.json();
                
                const directLine = window.WebChat.createDirectLine({ token });
                
                window.WebChat.renderWebChat(
                    {
                        directLine: directLine,
                        styleOptions: styleOptions
                    },
                    document.getElementById('webchat')
                );
            } catch (err) {
                console.error('Error initializing webchat:', err);
                document.getElementById('webchat').innerHTML = '<p style="padding: 20px; text-align: center; color: #DA2037;">Unable to load chat. Please refresh the page.</p>';
            }
        }

        initWebChat();
        
        function toggleFullscreen() {
            const container = document.getElementById('webchat-container');
            container.classList.toggle('fullscreen');
        }
    </script>
</body>
</html>
